name: mva-full-stack
domains:
- domain: fairwreck.com
  type: PRIMARY
- domain: www.fairwreck.com
  type: ALIAS
  wildcard: false
services:
- name: backend
  github:
    repo: bbarnes4318/mva
    branch: main
  dockerfile_path: Dockerfile.backend
  instance_count: 1
  instance_size_slug: basic-xxs
  http_port: 8000
  envs:
  - key: PORT
    value: "8000"
  - key: FLASK_ENV
    value: production
  - key: NODE_ENV
    value: production
  - key: PLAYWRIGHT_BROWSERS_PATH
    value: "0"
  - key: PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD
    value: "1"
  - key: PLAYWRIGHT_SKIP_VALIDATION
    value: "1"
  - type: SECRET
    key: EMAIL_USER
    value: ${EMAIL_USER}
  - type: SECRET
    key: EMAIL_PASS
    value: ${EMAIL_PASS}
  - type: SECRET
    key: FLASK_SECRET_KEY
    value: ${FLASK_SECRET_KEY}
  - type: SECRET
    key: PROXY_HOST
    value: ${PROXY_HOST}
  - type: SECRET
    key: PROXY_PORT
    value: ${PROXY_PORT}
  - type: SECRET
    key: PROXY_BASE_USER
    value: ${PROXY_BASE_USER}
  - type: SECRET
    key: PROXY_PASS
    value: ${PROXY_PASS}
  routes:
  - path: /api
- name: frontend
  source_dir: /web
  github:
    repo: bbarnes4318/mva
    branch: main
  build_command: npm run build
  run_command: npm run preview -- --host 0.0.0.0
  environment_slug: node-js
  instance_count: 1
  instance_size_slug: basic-xxs
  http_port: 4173
  envs:
  - key: VITE_CACHE_BUST
    value: "20250708"
  routes:
  - path: / 